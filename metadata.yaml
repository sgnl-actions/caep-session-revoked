# yaml-language-server: $schema=https://raw.githubusercontent.com/sgnl-actions/schemas/main/metadata.schema.json
name: caep-session-revoked
description: Transmits CAEP Session Revoked events as Security Event Tokens (SET)

# Input parameters for the session revoked event
inputs:
  subject:
    type: text
    description: Subject identifier JSON (e.g., {"format":"email","email":"user@example.com"})
    required: true
    validation:
      min: 1
      max: 2000

  audience:
    type: text
    description: Intended recipient of the SET (e.g., https://customer.okta.com/)
    required: true
    validation:
      min: 1
      max: 500

  address:
    type: text
    description: Optional destination URL override (defaults to ADDRESS environment variable)
    required: false
    validation:
      min: 1
      max: 100

  initiating_entity:
    type: text
    description: What initiated the session revocation (policy, admin, user, system)
    required: false
    validation:
      max: 100

  reason_admin:
    type: text
    description: Administrative reason for revocation (shown to admins)
    required: false
    validation:
      max: 1000

  reason_user:
    type: text
    description: User-facing reason for revocation (shown to users)
    required: false
    validation:
      max: 1000

# Expected output structure
outputs:
  status:
    type: text
    description: Operation result (success or failed)

  statusCode:
    type: number
    description: HTTP status code from the SET receiver

  body:
    type: text
    description: Response body from the SET receiver

  retryable:
    type: boolean
    description: Whether the error is retryable
