# Generated by sgnl-test-init â€” fill in the TODOs below
#
# Scenarios with "record: true" will be recorded by: npx sgnl-test-record
# Fill in real secrets in action.context.secrets, then run the recorder.
# After recording, redact secrets before committing.
action:
  params:
    subject: "{\"format\": \"email\", \"email\": \"test@sgnl.ai\"}"
    audience: https://audience.example.com
    address: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    initiating_entity: test-initiating_entity
    reason_admin: test-reason_admin
    reason_user: test-reason_user
  context:
    secrets:
      BEARER_AUTH_TOKEN: test-bearer-auth-token
    environment: {}
    crypto:
      signJWT:
        returns: eyJhbGciOiJSUzI1NiIsImtpZCI6IjllMjJlMjc2LWQzYTQtNGE2OS1hZDA4LWQyNmNmNWI0Y2ExOSIsInR5cCI6InNlY2V2ZW50K2p3dCJ9.eyJhdWQiOiJodHRwczovL3d3dy50ZXN0LmNvbSIsImV2ZW50cyI6eyJodHRwczovL3NjaGVtYXMub3BlbmlkLm5ldC9zZWNldmVudC9jYWVwL2V2ZW50LXR5cGUvc2Vzc2lvbi1yZXZva2VkIjp7ImV2ZW50X3RpbWVzdGFtcCI6MTc3MjIyOTM1Miwic3ViamVjdCI6eyJlbWFpbCI6InRlc3RAc2dubC5haSIsImZvcm1hdCI6ImVtYWlsIn19fSwiaWF0IjoxNzcyMjI5MzUyLCJpc3MiOiJodHRwczovL3NzZi5jYWVwLmRldi8iLCJqdGkiOiJPVGsyT0RObE9XTXRZVE00TXkwME1URm1MVGt3TjJNdE1qZzVOR1psWVdSbFlURXgiLCJzdWJfaWQiOnsiZW1haWwiOiJ0ZXN0QHNnbmwuYWkiLCJmb3JtYXQiOiJlbWFpbCJ9fQ.W-NVMIizwH1P56E1iU_L_ouHZtF3E3dgqVpcGDLKlPujhEw9omv5s2A9vac9nd5jhML9D_WuBTb0-YNL9N84NLxxjhxTXkG8KiQmO3mF-wn55-Xa_m_MOc6fn0vi2yUpf-TDmRBG9kQ4kHpw7qQgCfrr9XWCv8MrDAHssdAxNm6RDLLF-kVyXBC8n9J8AZle4_ifdti9npSnscMHgJC3XnnSXSTr1bFbZ8FbH8eMVKkb2XF_NkLJtPDX4IJt7Bs4z4dwEig9k8Xxe5_sXi-gA8Ghzak9VfG2i7hr1dhHCHgrfv_usoMR9PuNzeFUqhbfJ0Qqg8CSTSjh0gnnsszlzA
scenarios:
  - name: Base Success Case
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/base-success-case.http
    invoke:
      returns:
        status: success
        statusCode: 202
        body: ""
        headers:
          content-length: "0"
          date: Fri, 27 Feb 2026 21:58:35 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "8"
          x-request-id: b6c50865-7cbc-430e-a6e1-87156480ed02
          x-sgnl-istio-vs: sgnlapis-cloud-events
  - name: Duplicate Event
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/duplicate-event.http
    invoke:
      returns:
        status: failed
        statusCode: 409
        body:
          err: duplicate_event
          description: Failed to store the event. The event already exists.
        headers:
          content-length: "95"
          content-type: application/json
          date: Fri, 27 Feb 2026 22:01:18 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "4"
          x-request-id: 0ed7e181-d84f-43f6-986b-1fb424a328f6
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 409: Conflict"
        retryable: false
  - name: Invalid Bearer Token
    context:
      secrets:
        BEARER_AUTH_TOKEN: invalid-bearer-auth-token
    request:
      method: POST
      url: https://testing-client.sgnlapis.cloud/events/ssf/v1/04465422-8d45-460b-b5c5-82957f742c7c
    fixture: fixtures/invalid-bearer-token.http
    invoke:
      returns:
        status: failed
        statusCode: 400
        body:
          err: authentication_failed
          description: The SET Recipient could not authenticate the SET Transmitter.
        headers:
          content-length: "110"
          content-type: application/json
          date: Fri, 27 Feb 2026 22:02:50 GMT
          server: istio-envoy
          strict-transport-security: max-age=31536000;
          x-envoy-upstream-service-time: "3"
          x-request-id: e6fa61fa-73f0-47ee-b884-7b9672aafd19
          x-sgnl-istio-vs: sgnlapis-cloud-events
        error: "HTTP 400: Bad Request"
        retryable: false
